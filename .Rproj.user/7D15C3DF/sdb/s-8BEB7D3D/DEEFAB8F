{
    "contents" : "%\\VignetteEngine{knitr::knitr}\n\\documentclass[a4paper]{article}\n\n\\title{Usage of MODA}\n\\author{Dong Li \\\\ dxl466@cs.bham.ac.uk\\\\\nSchool of Computer Science, The University of Birmingham, UK\n}\n\\date{Date modified: \\Sexpr{Sys.Date()}}\n%\\VignetteIndexEntry{Usage of MODA}\n<<style-Sweave, eval=TRUE, echo=FALSE, results=tex>>=\nBiocStyle::latex()\n@\n\\begin{document}\n\\SweaveOpts{concordance=TRUE}\n\\maketitle\n\nIn this example we embed parts of the examples from the\n\\texttt{MODA} help page into a single document.\n\n\\section{Module detection}\nFirst of all we conduct the experiment on the synthetic dataset which contains two expression profiles $datExpr1$ and $datExpr2$ with 500 genes, and each has 20 and 25 samples. Details of data generation can be found in supplementary file of MODA paper \\cite{MODA}. Basic module detection functions are provided by WGCNA \\cite{WGCNA}.\n\n<<>>=\nlibrary(MODA)\ndata(synthetic)\nResultFolder = 'ForSynthetic' # where middle files are stored\nCuttingCriterion = 'Density' # could be Density or Modularity\nindicator1 = 'X'     # indicator for data profile 1\nindicator2 = 'Y'      # indicator for data profile 2\nspecificTheta = 0.1 #threshold to define condition specific modules\nconservedTheta = 0.1#threshold to define conserved modules\n##modules detection for network 1\nintModules1 <- WeightedModulePartitionDensity(datExpr1,ResultFolder,\n                                indicator1,CuttingCriterion)\n##modules detection for network 2\nintModules2 <- WeightedModulePartitionDensity(datExpr2,ResultFolder,\n                                indicator2,CuttingCriterion)\n@\nwhich shows how to detect modules using hierecal clustering with the optimal cutting height of dendrogram. The heatmap of correlation matrix of gene expression profile 1 may looks like Figure \\ref{fig:heat1}. Another package \\cite{link} has the similar function.\n\\begin{figure}\n\\centering\n<<fig=TRUE,echo=FALSE>>=\nheatmap(cor(as.matrix(datExpr1)))\n@\n\\caption{Correlation matrix of gene expression profile 1.}\n\\label{fig:heat1}\n\\end{figure}\n\nThe selection of optimal cutting height for each expression profile would be stored under directory $ResultFolder$. Take $datExpr1$ in the synthetic data for example, a file named $Partitions\\_X.pdf$ may looks like Figure \\ref{fig:cut1}.\n\\begin{figure}\n\\centering\n\\includegraphics{ForSynthetic/Partitions_X.pdf}\n\\caption{Maximal partition density based hierarchical clustering for gene expression profile 1.}\n\\label{fig:cut1}\n\\end{figure}\n\nAt the same time, each module for each expression profile would be stored as plain text file, with the name indicator from $indicator1$ and $indicator2$. Each secondary directory under $ResultFolder$ has the same name of condition name, e.g $indicator2$, used to store differential analysis results.\n\n\\section{Network comparison}\nAfter the module detection for background network and all condition-specific networks, we can compare them using following function\n<<>>=\nCompareAllNets(ResultFolder,intModules1,indicator1,intModules2,\n               indicator2,specificTheta,conservedTheta)\n@\n\nThe condition specific networks can be specified by two vectors if there are more. There are three files under the secondary directory named by condition name: two text files of them are condition specific and conserved modules id from background network, and one pdf for showing how to determine these modules by two parameters $specificTheta$ and $conservedTheta$ based on a Jaccard index matrix. Theoretical details can be found in supplementary file of MODA paper. The figure may looks like Figure \\ref{fig:compare}.\n\\begin{figure}\n\\centering\n\\includegraphics{ForSynthetic/Y/module_overlap_removeY.pdf}\n\\caption{Overlap degree of modules from two networks.}\n\\label{fig:compare}\n\\end{figure}\n\n\\section{Biological explanation}\nFinally we can do gene annotation enrichment analysis with intergative tools like DAVID\\footnote{https://david.ncifcrf.gov} or Enrichr\\footnote{http://amp.pharm.mssm.edu/Enrichr}, to see whether a module gene list can be explained by existing biological process, pathways or even diseases.\n\\section{Session info}\n<<sessionInfo, results=tex, echo=FALSE>>=\ntoLatex(sessionInfo())\n@\n \\begin{thebibliography}{1}\n\n  \\bibitem{MODA} Dong Li et al. {\\em MODA: MOdule Differential Analysis for weighted gene co-expression network} bioRxiv 053496 (2016).\n  \n  \\bibitem{WGCNA} Langfelder, Peter, and Steve Horvath. {\\em WGCNA: an R package for weighted correlation network analysis.} BMC bioinformatics 9.1 (2008): 1.\n  \n  \\bibitem{link} Kalinka, Alex T., and Pavel Tomancak. {\\em linkcomm: an R package for the generation, visualization, and analysis of link communities in networks of arbitrary size and type.} Bioinformatics 27.14 (2011).\n\n  \\end{thebibliography}\n\\end{document}",
    "created" : 1465070449557.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1684566552",
    "id" : "DEEFAB8F",
    "lastKnownWriteTime" : 1466613862,
    "path" : "D:/Code/MODA/vignettes/MODA.Rnw",
    "project_path" : "vignettes/MODA.Rnw",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "sweave"
}